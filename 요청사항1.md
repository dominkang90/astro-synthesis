개발팀과 공유할 수 있도록, 이전 대화의 **'Apple 스타일 디자인 시스템'**과 최신 소스들에서 분석된 **'통합 역학 알고리즘(AHP)', '법적 가이드라인'**을 모두 반영한 전문적인 `요청사항.md` 파일을 작성해 드립니다.

이 내용을 VSCode에 복사하여 `requirements.md`로 저장한 후 개발팀에 전달하시면 됩니다.

***

```markdown
# 🔮 Astro-Synthesis: AI 통합 역학 플랫폼 개발 요청사항

## 1. 프로젝트 개요
*   **프로젝트명:** Astro-Synthesis (가칭)
*   **목표:** 서양 점성술, 동양 사주(만세력), AI 관상 분석을 통합하여 모순 없는 단일 운세 리포트를 제공하는 하이브리드 웹/앱 플랫폼 구축.
*   **핵심 가치:** Swiss Ephemeris 수준의 천문학적 정밀도와 AHP(계층화 분석법) 기반의 논리적 해석 통합.
*   **디자인 컨셉:** Apple Design System을 차용한 'Cosmic Clarity' (미니멀리즘 + 높은 정보 밀도).

---

## 2. 기술 스택 및 라이브러리 (Tech Stack)
### 2.1 Backend (Python)
*   **Core Framework:** FastAPI (비동기 처리 및 확장성 용이) [Source 697]
*   **Astrology Engine:**
    *   `pyswisseph`: NASA JPL DE431 데이터 기반 고정밀 천문 계산 (필수) [Source 648, 1134]
    *   `kerykeion`: 차트 데이터 구조화 및 SVG 생성, LLM 프롬프트용 컨텍스트 시리얼라이저 활용 [Source 799, 825]
    *   `stellium`: 23개 이상의 하우스 시스템 지원 및 데이터 분석용 [Source 725, 1136]
*   **AI & ML:**
    *   **LLM Integration:** OpenAI GPT-4o 또는 Google Gemini Pro (해석 생성용)
    *   **Computer Vision:** Google MediaPipe Face Mesh (468개 3D 랜드마크 추출) [Source 502, 1137]

### 2.2 Frontend
*   **Stack:** React 또는 순수 HTML/JS (프로토타입 단계)
*   **Visualization:**
    *   `AstroChart` (JS Library): 웹상에서 동적 천궁도 렌더링 [Source 186]
    *   SVG 렌더링: 백엔드(`kerykeion`)에서 생성된 SVG를 프론트에서 스타일링하여 표시 [Source 805]

---

## 3. 핵심 기능 명세 (Functional Requirements)

### 3.1 통합 해석 엔진 (Correlation Engine)
*   **알고리즘:** AHP (Analytic Hierarchy Process) 및 SAW (Simple Additive Weighting) 모델 적용 [Source 227, 428]
*   **가중치 로직:** 사용자의 질문 의도에 따라 동적으로 가중치 할당
    *   *예: 심리 상담 → 점성술(0.7) > 사주(0.3)*
    *   *예: 시기/택일 → 사주(0.7) > 점성술(0.3)*
*   **충돌 해결:** 상반된 결과(길/흉) 발생 시, AHP 점수가 높은 시스템의 해석을 우선 노출하고 낮은 쪽은 '보완적 조언'으로 처리.

### 3.2 서양 점성술 (Western Astrology)
*   **필수 데이터:** 행성(태양~명왕성), 하우스 커스프, 아스펙트(메이저/마이너).
*   **하우스 시스템:** Placidus를 기본으로 하되, Whole Sign, Koch, Regiomontanus 선택 옵션 제공 [Source 535].
*   **특수 기능:**
    *   Dignities (행성의 위계) 계산 [Source 738]
    *   Retrograde (역행) 표시.

### 3.3 동양 사주 (Eastern Saju)
*   **만세력 엔진:** 1900년~2050년 범위를 커버하는 정밀 만세력 구현.
*   **필수 계산:**
    *   사주팔자(8글자), 대운(10년 주기), 세운(년운).
    *   십신(Ten Gods), 12신살, 용신/기신 분석 [Source 532].
*   **보정 로직:** 한국 서머타임(DST) 역사 및 도쿄/서울 표준시 변경 이력 자동 반영 [Source 936, 1145].

### 3.4 AI 관상 분석 (Physiognomy)
*   **처리 프로세스:**
    1.  사용자 사진 업로드 (전송 구간 암호화 필수).
    2.  MediaPipe로 468개 랜드마크 추출 [Source 502].
    3.  **Canonical Face Model**에 매핑하여 3D 거리/비율 측정 [Source 494].
    4.  측정값을 관상학 12궁(명궁, 재백궁 등) 이론에 대입하여 해석 [Source 539].
*   **보안:** 원본 사진은 특징점 추출 즉시 서버 메모리에서 파기 (DB 저장 금지).

---

## 4. 데이터 및 보안 요구사항 (Security & Privacy)
### 4.1 생체정보 보호 (법적 필수)
*   **별도 동의:** '개인정보 수집 이용 동의'와 분리하여 **'민감정보(생체인식정보) 처리에 대한 별도 동의'** 체크박스 구현 [Source 934, 538].
*   **데이터 격리:** 만약 원본 사진을(동의 하에) 임시 저장해야 할 경우, 일반 개인정보(이름, 연락처)와 물리적/논리적으로 분리된 서버/스토리지에 암호화하여 저장 [Source 929, 995].

### 4.2 윤리적 가이드라인 (Ethical Guardrails)
*   **필터링:** '사망', '수명', '난치병', '자살' 등 고위험 키워드가 포함된 질문이나 예측 결과는 LLM 단계에서 필터링 [Source 1142].
*   **면책 조항:** 모든 결과 화면 하단에 "본 결과는 통계적 분석이며 의학적/법적 조언을 대체하지 않습니다" 문구 명시.

---

## 5. UI/UX 디자인 가이드 (Design System)
### 5.1 레이아웃 전략: Bento Grid
*   복잡한 역학 데이터를 Apple 스타일의 카드형 그리드(Bento Grid)로 정리하여 정보 밀도를 높이면서도 가독성 확보 [Source 943].
*   **계층적 공개:** 초기 화면은 핵심 결론(Synthesis)만 보여주고, 클릭 시 상세 차트(Drill-down)로 진입.

### 5.2 모바일 최적화
*   **반응형 차트:** 모바일 화면에서도 SVG 차트가 깨지지 않고 줌인/줌아웃 되도록 구현 [Source 702].
*   **다크 모드:** 'Cosmic Theme' (Deep Blue/Black 배경 + Gold/White 텍스트) 기본 적용.

---

## 6. 엣지 케이스 대응 (Edge Cases)
*   **출생 시간 모름:** 과거 주요 사건(결혼, 취업 등)을 입력받아 시간을 역추적하는 '보시(Rectification)' 알고리즘 프로세스 구현 [Source 197, 1140].
*   **극지방 출생:** 위도 66도 이상 입력 시, 하우스 시스템이 붕괴되지 않도록 자동으로 'Porphyry' 또는 'Whole Sign'으로 전환 처리 [Source 43, 1140].
```